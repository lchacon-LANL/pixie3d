c-----------------------------------------------------------------------
c     file debug.f.
c     prints matrix.
c-----------------------------------------------------------------------
c-----------------------------------------------------------------------
c     code organization.
c-----------------------------------------------------------------------
c     0. debug_mod
c     1. debug1
c     2. debug2
c-----------------------------------------------------------------------
c     subprogram 0. debug_mod.
c     module declarations.
c-----------------------------------------------------------------------
c-----------------------------------------------------------------------
c     declarations.
c-----------------------------------------------------------------------
      MODULE debug_mod
      USE local_mod
      IMPLICIT NONE

      CONTAINS
c-----------------------------------------------------------------------
c     subprogram 1. debug1.
c     prints matrix in column form.
c-----------------------------------------------------------------------
c-----------------------------------------------------------------------
c     declarations.
c-----------------------------------------------------------------------
      SUBROUTINE debug1(u,name,unit)

      COMPLEX(r8), DIMENSION(:,:,:), INTENT(IN) :: u
      CHARACTER(*), INTENT(IN) :: name
      INTEGER :: unit

      CHARACTER(80) :: format1,format2
      INTEGER :: ipert,isol,iqty,mpert,msol,mqty
c-----------------------------------------------------------------------
c     format statements.
c-----------------------------------------------------------------------
 10   FORMAT('(/3x,"isol",2x,"ipert",',
     $     i1,'(5x,"re ",i1,7x,"im ",i1,4x)/)')
 20   FORMAT('(2i6,1p,',i1,'(2x,2e11.3))')
c-----------------------------------------------------------------------
c     compute sizes.
c-----------------------------------------------------------------------
      mpert=SIZE(u,1)
      msol=SIZE(u,2)
      mqty=SIZE(u,3)
c-----------------------------------------------------------------------
c     create formats.
c-----------------------------------------------------------------------
      WRITE(format1,10)mqty
      WRITE(format2,20)mqty
c-----------------------------------------------------------------------
c     write array.
c-----------------------------------------------------------------------
      WRITE(unit,'(a,":")')TRIM(name)
      WRITE(unit,format1)(iqty,iqty,iqty=1,mqty)
      DO isol=1,msol
         DO ipert=1,mpert
            WRITE(unit,format2)isol,ipert,u(ipert,isol,:)
         ENDDO
         WRITE(unit,format1)(iqty,iqty,iqty=1,mqty)
      ENDDO
c-----------------------------------------------------------------------
c     terminate.
c-----------------------------------------------------------------------
      RETURN
      END SUBROUTINE debug1
      END MODULE debug_mod
